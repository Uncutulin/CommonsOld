function ShowLoader(t, e) { var a = $(t); var i = a.find(".holder")[0]; var n = a.find(".modal-body"); n[0].style.visibility = "hidden"; if (e) { var o = a.find(".preloader-text")[0]; o.innerHTML = e } i.style.display = "" } function HideLoader(t) { var e = $(t); var a = e.find(".holder")[0]; var i = e.find(".modal-body"); a.style.display = "none"; i[0].style.visibility = ""; var n = e.find(".preloader-text")[0]; n.innerHTML = "" } function LoadModal(e, t, a) { var i = $(e); var n = i[0].getAttribute("data-loader-text"); ShowLoader(e, n); i.modal("show"); $.ajax({ url: t + a, success: function (t) { updateModalContent(e, t) } }) } function updateModalContent(t, e) { var a = $(t); var i = a.find(".modal-body"); i.html(e); var n = $(t).find("img, iframe, embed"); if (window.navigator.userAgent.indexOf("MSIE ") > 0) { n = $(t).find("img, iframe") } var o = n.length; if (o == 0) { HideLoader(a) } var r = 0; n.on("load", function () { r++; if (r == o) { HideLoader(t) } }); a.find("form").filter(':not([href="\\#"], [href*="javascript"], [data-ajax="true"])').each(function () { $(this).on("submit", function (t) { var e = $(t.currentTarget)[0].getAttribute("data-loader-text"); console.log(e); ShowLoader(a, e) }) }); a.find("a[href]").filter(':not([href="\\#"], [href*="javascript"], [data-ajax="true"])').each(function () { $(this).on("click", function (t) { var e = $(t.currentTarget)[0].getAttribute("data-loader-text"); ShowLoader(a, e) }) }); if (a.hasClass("recursive-modal")) { MakeRecursive(t) } } function MakeRecursive(t) { var o = $(t); o.find("form").each(function () { $(this).on("submit", function (t) { var e = $(this); var a = e.attr("action"); var i = e.attr("data-ajax"); var n = e.find('input[type="file"]'); if (a && !i && !n[0]) { t.preventDefault(); $.ajax({ type: "POST", url: a, data: e.serialize(), success: function (t) { if (t.indexOf("<!DOCTYPE html>") > -1) { if (!(typeof history.pushState === "undefined")) { history.pushState({ url: a, title: document.title }, document.title, a) } document.open(); document.write(t); document.close() } else { updateModalContent(o, t) } } }) } }) }); o.find("a").each(function () { $(this).on("click", function (t) { var e = $(this); var a = e.attr("href"); var i = e.attr("data-ajax"); if (a && a !== "#" && !i) { t.preventDefault(); t.stopPropagation(); $.ajax({ type: "POST", url: a, success: function (t) { if (t.indexOf("<!DOCTYPE html>") > -1) { if (!(typeof history.pushState === "undefined")) { history.pushState({ url: a, title: document.title }, document.title, a) } document.open(); document.write(t); document.close() } else { updateModalContent(o, t) } } }) } }) }) }